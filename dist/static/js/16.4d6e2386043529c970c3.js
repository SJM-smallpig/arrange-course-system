webpackJsonp([16],{EhRQ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("pFYg"),s=a.n(r),l=a("mvHQ"),o=a.n(l),i=a("7t+N"),n=a.n(i),m={components:{},props:{},data:function(){return{edit:!1,addShow:!0,taskId:"",form:{taskName:"",grade:"高一",classCategory:"行政班",subjectTeacherNumber:[{subject:"人数",Physics:"52",Chemistry:"30",Biology:"50",Geography:"00",History:"10",Politics:"20",sum:""}],sectionStudentNumber:[],miniNums:"",maxNums:"",runingTime:""},isNameExit:!1,isShowName:!0}},watch:{},computed:{taskLists:function(){return this.$store.state.taskLists}},methods:{getSum:function(e){var t=[];for(var a in e)t.push(parseInt(e[a]));t.pop(t.length-1),t.shift(1);var r=t.reduce(function(e,t){return e+t},0);e.sum=r;for(var s=n()("tbody").eq(2).find("tr"),l=0;l<s.length-1;l++)n()("tbody:eq(2) tr:eq("+l+") .cell:eq(2)").css("visibility","hidden")},goBack:function(){this.$router.go(-1)},deleteRow:function(e,t){t.splice(e,1);var a=n()(".time-table").find("tr").length-2;n()(".time-table tr:eq("+a+") .cell:eq(2)").css("visibility","visible")},addTime:function(e,t){var a=e.split(":"),r=parseInt(a[0]),s=parseInt(a[1])+t;if(s>=60){var l=s-60;s=l,l<60&&(r+=1)}return 1==r.toString().length&&(r="0"+r),1==s.toString().length&&(s="0"+s),r>=22&&s>=30?e:[r,s].join(":")},addTimeRow:function(){var e=n()(".time-table").find("tr").length-1,t=this.form.timeTable[e-1].time.endTime,a=this.addTime(t,55),r=this.addTime(a,45);if(a==t)alert("已超过最大时间，不能继续添加"),this.addShow=!1;else{var s={section:"第"+(e+1)+"节课",time:{startTime:a,endTime:r}};this.form.timeTable.push(s)}},submitForm:function(e,t){var a=this,r=this;if(0==r.isNameExit){console.log("访问");var l=JSON.parse(o()(t)),i=l.sectionStudentNumber[0],n=l.subjectTeacherNumber[0],m=[],u=[];for(var c in i)m.push(i[c]);for(var d in n)u.push(n[d]);m.pop(1),m.shift(1),u.pop(1),u.shift(1);var p=[];p[0]=m[0],p[1]=m[2],p[2]=m[6],p[3]=m[4],p[4]=m[8],p[5]=m[10],p[6]=m[1],p[7]=m[3],p[8]=m[7],p[9]=m[5],p[10]=m[9],p[11]=m[11],l.sectionStudentNumber=p,l.subjectTeacherNumber=u,console.log(p);var h=[];h.push(l.maxNums),h.push(l.miniNums),delete l.miniNums,delete l.maxNums,delete l.classCategory,l.maxAndMinClassStudentNumber=h,l.runingTime=l.runingTime.toString(),console.log(s()(l.runingTime)),r.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;r.$axios({url:a.$root.URL+"/createtask",method:"post",headers:{"Content-Type":"application/json;charset=utf-8"},data:o()(l),crossDomain:!0}).then(function(e){200===e.status&&("ok"==e.data.message&&(r.taskId=e.data.taskId),console.log(r.form.sectionStudentNumber),r.$router.push({path:"@/components/rulesStage/RuleOneStage",name:"ruleOneStage",query:{form:r.form,taskId:r.taskId}}))}).catch(function(e){e.response?404===e.response.status&&r.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):(r.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",e.message)),console.log(e.request)})})}else r.$router.push({path:"@/components/rulesStage/RuleOneStage",name:"ruleOneStage",query:{form:r.form,taskId:r.form.taskName}})},getTaskRule:function(e){var t=this;void 0!=e&&t.$axios({url:this.$root.URL+"/rule?taskId="+e,method:"get",crossDomain:!0}).then(function(e){200===e.status&&(0==e.data.statusCode?(t.edit=!0,t.isNameExit=!0,t.form.miniNums=e.data.rule.maxAndMinClassStudentNumber[0],t.form.maxNums=e.data.rule.maxAndMinClassStudentNumber[1],t.form.runingTime=e.data.rule.runing_time):t.isNameExit=!1)}).catch(function(e){e.response?404===e.response.status&&t.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):(t.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",e.message)),console.log(e.request)})}},created:function(){var e=this;e.$axios({url:this.$root.URL+"/data?object=student",method:"get",crossDomain:!0}).then(function(t){200===t.status&&e.form.sectionStudentNumber.push(t.data)}).catch(function(t){t.response?404===t.response.status&&e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):t.request?(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log(t.request)):(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",t.message)),console.log(t.request)})},mounted:function(){if(void 0==this.$route.query.taskName)this.isShowName=!1;else{this.isShowName=!0;var e=this.$route.query;this.form.taskName=e.taskName,this.getTaskRule(this.form.taskName)}if(void 0!=this.$route.params.taskId){this.edit=!0;var t=this.$route.params;this.form.miniNums=t.formData[0].miniNums,this.form.maxNums=t.formData[0].maxNums,this.form.runingTime=t.formData[0].runingTime}else this.edit=!1},updated:function(){}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"s-main"},[a("el-page-header",{staticClass:"back-head",attrs:{content:"设置分班规则"},on:{back:e.goBack}}),e._v(" "),a("div",{staticClass:"s-form"},[a("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,"label-width":"180px","label-position":"right"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowName,expression:"isShowName"}],attrs:{label:"任务名称"}},[a("span",{staticClass:"task-name"},[e._v(e._s(e.form.taskName))])]),e._v(" "),a("el-form-item",{attrs:{label:"年级"}},[a("el-radio-group",{model:{value:e.form.grade,callback:function(t){e.$set(e.form,"grade",t)},expression:"form.grade"}},[a("el-radio",{attrs:{label:"高一"}}),e._v(" "),a("el-radio",{attrs:{label:"高二"}}),e._v(" "),a("el-radio",{attrs:{label:"高三"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"班类"}},[a("el-radio-group",{model:{value:e.form.classCategory,callback:function(t){e.$set(e.form,"classCategory",t)},expression:"form.classCategory"}},[a("el-radio",{attrs:{label:"行政班"}}),e._v(" "),a("el-radio",{attrs:{label:"教学班"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"学生选科组合人数"}},[a("el-table",{key:e.form.index,staticClass:"st-table",attrs:{data:e.form.sectionStudentNumber,border:"",size:"mini",id:"st-table","header-cell-style":{background:"#eef1f6",color:"#606266"}},model:{value:e.form.sectionStudentNumber,callback:function(t){e.$set(e.form,"sectionStudentNumber",t)},expression:"form.sectionStudentNumber"}},[a("el-table-column",{attrs:{prop:"1",label:"科目",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"50",label:"历地政",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"26",label:"历地生",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"22",label:"历地化",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"42",label:"历政生",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"38",label:"历政化",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"14",label:"历生化",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"49",label:"物地政",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"25",label:"物地生",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"21",label:"物地化",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"41",label:"物政生",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"37",label:"物政化",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"13",label:"物生化",align:"center",width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sum",label:"总计",align:"center",width:"60px"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"老师科目人数"}},[a("el-table",{staticClass:"t-table",attrs:{data:e.form.subjectTeacherNumber,border:"",size:"mini",id:"st-table","header-cell-style":{background:"#eef1f6",color:"#606266"}},model:{value:e.form.subjectTeacherNumber,callback:function(t){e.$set(e.form,"subjectTeacherNumber",t)},expression:"form.subjectTeacherNumber"}},[a("el-table-column",{attrs:{prop:"subject",label:"科目",align:"center",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Physics",label:"物理",align:"center",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Chemistry",label:"化学",align:"center",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Biology",label:"生物",align:"center",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Geography",label:"地理",align:"center",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"History",label:"历史",align:"center",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Politics",label:"政治",align:"center",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sum",label:"总计",align:"center",width:"80px"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"班级最少人数",prop:"miniNums",rules:[{required:!0,message:"该空不能为空"},{type:"number",message:"该空必须为数字值"}]}},[a("el-input",{staticClass:"input",staticStyle:{width:"200px"},attrs:{type:"text",autocomplete:"off",maxlength:"3",placeholder:"请输入数字",disabled:e.edit},model:{value:e.form.miniNums,callback:function(t){e.$set(e.form,"miniNums",e._n(t))},expression:"form.miniNums"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"班级最多人数",prop:"maxNums",rules:[{required:!0,message:"该空不能为空"},{type:"number",message:"该空必须为数字值"}]}},[a("el-input",{staticClass:"input",staticStyle:{width:"200px"},attrs:{type:"text",autocomplete:"off",maxlength:"3",placeholder:"请输入数字",disabled:e.edit},model:{value:e.form.maxNums,callback:function(t){e.$set(e.form,"maxNums",e._n(t))},expression:"form.maxNums"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务运行时间",prop:"runingTime",rules:[{required:!0,message:"该空不能为空"},{type:"number",message:"该空必须为数字值"}]}},[a("el-input",{staticClass:"input",staticStyle:{width:"200px"},attrs:{type:"text",autocomplete:"off",maxlength:"2",placeholder:"请输入数字",disabled:e.edit},model:{value:e.form.runingTime,callback:function(t){e.$set(e.form,"runingTime",e._n(t))},expression:"form.runingTime"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticClass:"save"},[e._v("保存")]),e._v(" "),a("el-button",{staticClass:"sub",attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form",e.form)}}},[e._v("开始分班")])],1)],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(m,u,!1,function(e){a("hrCH")},"data-v-2da4457a",null);t.default=c.exports},hrCH:function(e,t){}});
//# sourceMappingURL=16.4d6e2386043529c970c3.js.map