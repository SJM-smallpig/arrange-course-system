webpackJsonp([10],{"1oqs":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("7t+N");var o={components:{},props:{},data:function(){return{showSubGroupData:!1,showBegin:!0,showHook:!0,showLoading:!1,status:"进行中",isModify:"修改",formData:[],taskId:"",isNameExit:!1,oneResutltData:[],subGroupData:[{subject:"人数","生化":"","地化":"","地生":"","政化":"","政生":"","地政":""}],firstGroup:[],secondGroup:[],thirtGroup:[],runingTime:0}},watch:{},computed:{taskLists:function(){return this.$store.state.taskLists}},methods:{ergodicGroup:function(t,e,a,o,r){for(var s=0;s<o.length;s++)for(var l in o[s])"comColumn"==l&&o[s].comColumn==t&&(o[s].numColumn=(a-e).toFixed(1));for(var i=0;i<r.length;i++)for(var n in r[i])"comColumn"==n&&r[i].comColumn==t&&(r[i].numColumn=(a-e).toFixed(1))},editData:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t.edit=!t.edit;var a=void 0;null!=e&&(a=e.property);var o=void 0,r=void 0,s=t.comColumn,l=t.numColumn,i=this.subGroupData,n=void 0;for(var u in i[0])u==s&&(n=i[0][u]);!1===t.edit&&(t.numColumn=parseInt(l).toFixed(1),"firstGroup"==a?(o=this.secondGroup,r=this.thirtGroup,this.ergodicGroup(s,l,n,o,r)):"secondGroup"==a?(o=this.firstGroup,r=this.thirtGroup,this.ergodicGroup(s,l,n,o,r)):(o=this.firstGroup,r=this.secondGroup,this.ergodicGroup(s,l,n,o,r)))},handleChange:function(t){},getTotalAndDiffData:function(t,e){var a=[];for(var o in t)for(var r in t[o])if("string"==typeof t[o][r]&&1==t[o][r].includes("/")){a=t[o][r].split("/");for(var s=0;s<a.length;s++)a[s]=Number(a[s]).toFixed(2);t[o][r]=a.join("/")}var l=[];for(var i in t[3])t[3][i]=Number(t[3][i]).toFixed(2),l.push(t[3][i]);t[3].group="总计";for(var n=[],u=0;u<e.length;u++){var c=e[u]-l[u];n.push(Number(c).toFixed(2))}var p={};p[4]=n[0],p[8]=n[1],p[16]=n[2],p[32]=n[3],p.group="差值",t.push(p)},oneStageBegin:function(){var t=this;if(t.isShowPage=!0,t.showBegin=!1,t.showLoading=!0,0==t.showBegin){var e=t.formData[0].sectionStudentNumber[0],a=[],o=[],r=0;for(var s in e)a.push(e[s]);a.pop(),a.shift();for(var l=0;l<a.length;l+=2)r=Number(a[l])+Number(a[l+1]),o.push(r);t.subGroupData[0]["地政"]=o[0],t.subGroupData[0]["地生"]=o[1],t.subGroupData[0]["政生"]=o[2],t.subGroupData[0]["地化"]=o[3],t.subGroupData[0]["政化"]=o[4],t.subGroupData[0]["生化"]=o[5]}t.$axios({url:t.$root.URL+"/runtask?taskId="+t.taskId+"&stage=1",method:"post",crossDomain:!0}).then(function(e){200===e.status&&(t.timer=setInterval(function(){t.$axios({url:t.$root.URL+"/result?distribution=0&stage=1&taskId="+t.taskId,method:"get",crossDomain:!0}).then(function(e){200===e.status&&""!=e.data&&(clearInterval(t.timer),t.getTotalAndDiffData(e.data.scoreTable,e.data.minClassNumber),t.oneResutltData=e.data.scoreTable,t.firstGroup=e.data.resultData["第1组"],t.secondGroup=e.data.resultData["第2组"],t.thirtGroup=e.data.resultData["第3组"],t.showLoading=!1,t.showSubGroupData=!0,t.status="完成")}).catch(function(e){clearInterval(t.timer),e.response?404===e.response.status&&t.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):e.request?(t.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log(e.request)):(t.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",e.message)),console.log(e.request)})},1e4))}).catch(function(t){console.log(t)})},nextTwoPart:function(){0==this.showHook?(this.showHook=!0,this.isModify="修改"):(this.showHook=!1,this.isModify="确定")},toRuleTwoStage:function(){"修改"==this.isModify?this.$router.push({path:"@/components/rulesStage/RuleTwoStage",name:"ruleTwoStage",query:{taskId:this.taskId,isNameExit:this.isNameExit,formData:this.formData[0]}}):alert("请先点击确认修改按钮！")},getTaskOneStageData:function(t){var e=this;e.$axios({url:this.$root.URL+"/taskstatus?taskId="+t,method:"get",crossDomain:!0}).then(function(a){if(200===a.status)for(var o in a.data.tasksStageMap)if(o==t)if(a.data.tasksStageMap[o]<1)e.isNameExit=!1;else{e.isNameExit=!0,e.showLoading=!1,e.showSubGroupData=!0,e.showBegin=!1,e.status="已完成",console.log(e.formData[0]);var r=e.formData[0].sectionStudentNumber[0],s=[],l=[],i=0;for(var o in r)s.push(r[o]);s.pop(),s.shift(),console.log(r);for(var n=0;n<s.length;n+=2)i=Number(s[n])+Number(s[n+1]),l.push(i);e.subGroupData[0]["地政"]=l[0],e.subGroupData[0]["地生"]=l[1],e.subGroupData[0]["政生"]=l[2],e.subGroupData[0]["地化"]=l[3],e.subGroupData[0]["政化"]=l[4],e.subGroupData[0]["生化"]=l[5],e.$axios({url:e.$root.URL+"/result?stage=1&distribution=0&taskId="+e.taskId,method:"get",crossDomain:!0}).then(function(t){200===t.status&&""!=t.data&&(e.getTotalAndDiffData(t.data.scoreTable,t.data.minClassNumber),e.oneResutltData=t.data.scoreTable,e.firstGroup=t.data.resultData["第1组"],e.secondGroup=t.data.resultData["第2组"],e.thirtGroup=t.data.resultData["第3组"])}).catch(function(t){t.response?404===t.response.status&&e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):t.request?(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log(t.request)):(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",t.message)),console.log(t.request)})}}).catch(function(t){t.response?404===t.response.status&&e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):t.request?(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log(t.request)):(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",t.message)),console.log(t.request)})},getTaskRule:function(t){var e=this;e.$axios({url:e.$root.URL+"/rule?taskId="+t,method:"get",crossDomain:!0}).then(function(t){200===t.status&&console.log(t.data)}).catch(function(t){t.response?404===t.response.status&&e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):t.request?(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log(t.request)):(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",t.message)),console.log(t.request)})}},created:function(){},mounted:function(){if(this.$route.query)if("[object Object]"===this.$route.query.form);else{var t=this.$route.query;this.taskId=t.taskId,this.formData.push(t.form),this.formData[0].taskName=t.taskId,this.runingTime=t.form.runingTime}if(this.$route.params.form){var e=this.$route.params.form;this.formData.push(e),this.taskId=this.$route.params.taskId,this.getTaskRule(this.taskId)}void 0==this.taskId&&""==this.taskId||this.getTaskOneStageData(this.taskId)},beforeDestroy:function(){clearInterval(this.timer)},beforeRouteLeave:function(t,e,a){t.params.taskId=this.taskId,t.params.formData=this.formData,a()},destroyed:function(){}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"r-main"},[t._l(t.formData,function(e){return[a("el-form",{key:e.index,staticClass:"demo-table-expand",attrs:{"label-position":"left"}},[a("el-form-item",{attrs:{label:"任务名称"}},[a("div",{staticStyle:{"border-bottom":"1px solid #bababa"}},[a("span",[t._v(t._s(e.taskName))])])]),t._v(" "),a("el-form-item",{attrs:{label:"年级"}},[a("div",{staticStyle:{"border-bottom":"1px solid #bababa"}},[a("span",[t._v(t._s(e.grade))])])]),t._v(" "),a("el-form-item",{attrs:{label:"班类"}},[a("span",[t._v(t._s(e.classCategory))])]),t._v(" "),a("el-form-item",{attrs:{label:"学生选科人数"}},[a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.sectionStudentNumber,expression:"item.sectionStudentNumber"}],staticClass:"s-table",attrs:{data:e.sectionStudentNumber,border:"",size:"mini","header-cell-style":{background:"#eef1f6",color:"#606266"}},model:{value:e.sectionStudentNumber,callback:function(a){t.$set(e,"sectionStudentNumber",a)},expression:"item.sectionStudentNumber"}},[a("el-table-column",{attrs:{prop:"1",label:"科目",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"13",label:"历地政",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"21",label:"历地生",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"37",label:"历地化",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"25",label:"历政生",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"41",label:"历政化",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"49",label:"历生化",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"14",label:"物地政",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"22",label:"物地生",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"38",label:"物地化",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"26",label:"物政生",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"42",label:"物政化",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"50",label:"物生化",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sum",label:"总计",align:"center",width:"60px"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"老师各科人数"}},[a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.subjectTeacherNumber,expression:"item.subjectTeacherNumber"}],staticClass:"t-table",attrs:{data:e.subjectTeacherNumber,border:"",size:"mini","header-cell-style":{background:"#eef1f6",color:"#606266"}},model:{value:e.subjectTeacherNumber,callback:function(a){t.$set(e,"subjectTeacherNumber",a)},expression:"item.subjectTeacherNumber"}},[a("el-table-column",{attrs:{prop:"subject",label:"科目",align:"center",width:"50px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Physics",label:"物理",align:"center",width:"50px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Chemistry",label:"化学",align:"center",width:"50px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Biology",label:"生物",align:"center",width:"50px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Geography",label:"地理",align:"center",width:"50px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"History",label:"历史",align:"center",width:"50px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sum",label:"总计",align:"center",width:"50px"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"班级人数范围"}},[a("span",[t._v(t._s(e.miniNums)+" -- "+t._s(e.maxNums))])]),t._v(" "),a("el-form-item",{attrs:{label:"任务运行时间"}},[a("span",[t._v(t._s(e.runingTime))])]),t._v(" "),a("el-form-item",{attrs:{label:"任务状态"}},[a("span",{staticClass:"status"},[t._v("分班第一阶段:")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showBegin,expression:"showBegin"}],attrs:{type:"primary",round:"",size:"mini"},on:{click:t.oneStageBegin}},[t._v("开始")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showBegin,expression:"!showBegin"}],staticClass:"showing"},[a("span",{staticClass:"status"},[t._v(t._s(t.status))]),t._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:!t.showSubGroupData,expression:"!showSubGroupData"}],staticClass:"el-icon-refresh-right status el-making"})])],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.showLoading,expression:"showLoading"}]},[a("div",{staticClass:"spinner"},[a("div",{staticClass:"bounce1"}),t._v(" "),a("div",{staticClass:"bounce2"}),t._v(" "),a("div",{staticClass:"bounce3"})])]),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.showSubGroupData,expression:"showSubGroupData"}],attrs:{label:""}},[a("div",{staticClass:"stage-one"},[a("el-table",{staticClass:"group-num-table",attrs:{data:t.subGroupData,border:"",size:"mini","header-cell-style":{background:"#eef1f6",color:"#606266"}},model:{value:t.subGroupData,callback:function(e){t.subGroupData=e},expression:"subGroupData"}},[a("el-table-column",{attrs:{prop:"subject",label:"科目组合",align:"center",width:"80px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"生化",label:"生化",align:"center",width:"80px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"地化",label:"地化",align:"center",width:"80px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"地生",label:"地生",align:"center",width:"80px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"政化",label:"政化",align:"center",width:"80px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"政生",label:"政生",align:"center",width:"80px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"地政",label:"地政",align:"center",width:"80px"}})],1),t._v(" "),a("div",{staticClass:"result-sty"},[t._v("第一阶段参考评分如下:")]),t._v(" "),a("el-table",{staticClass:"one-result-table",attrs:{data:t.oneResutltData,border:"",size:"mini","header-cell-style":{background:"#eef1f6",color:"#606266"}},model:{value:t.oneResutltData,callback:function(e){t.oneResutltData=e},expression:"oneResutltData"}},[a("el-table-column",{attrs:{prop:"group",label:"分组",align:"center",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"4",label:"地理",align:"center",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"8",label:"政治",align:"center",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"16",label:"生物",align:"center",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"32",label:"化学",align:"center",width:"150px"}})],1)],1),t._v(" "),a("div",{staticClass:"stage-one"},[a("div",{staticClass:"result-sty"},[t._v("第一阶段生成结果如下:")]),t._v(" "),a("el-table",{staticClass:"group-table",attrs:{data:t.firstGroup,size:"mini",border:"",stripe:""},model:{value:t.firstGroup,callback:function(e){t.firstGroup=e},expression:"firstGroup"}},[a("el-table-column",{attrs:{label:"第一组",align:"center"}},[a("el-table-column",{attrs:{prop:"comColumn",label:"科目组合",width:"100px",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"numColumn",label:"人数",width:"100px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?a("el-input",{staticClass:"edit-input",attrs:{placeholder:e.row.numColumn},model:{value:e.row.numColumn,callback:function(a){t.$set(e.row,"numColumn",a)},expression:"scope.row.numColumn"}}):a("span",[t._v(t._s(e.row.numColumn))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100",align:"center",prop:"firstGroup"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showHook,expression:"!showHook"}]},[e.row.edit?a("div",[a("el-button",{staticClass:"edit-confirm-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-check",circle:""},on:{click:function(a){return t.editData(e.row,e.column)}}})],1):a("div",[a("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){return t.editData(e.row)}}},[a("i",{staticClass:"el-icon-edit",attrs:{"aria-hidden":"true"}})])],1)]),t._v(" "),a("div",[a("i",{directives:[{name:"show",rawName:"v-show",value:t.showHook,expression:"showHook"}],staticClass:"el-icon-check check"})])]}}],null,!0)})],1)],1),t._v(" "),a("el-table",{staticClass:"group-table",attrs:{data:t.secondGroup,border:"",stripe:"",size:"mini"},model:{value:t.secondGroup,callback:function(e){t.secondGroup=e},expression:"secondGroup"}},[a("el-table-column",{attrs:{label:"第二组",align:"center"}},[a("el-table-column",{attrs:{prop:"comColumn",label:"科目组合",width:"100",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"numColumn",label:"人数",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?a("el-input",{staticClass:"edit-input",attrs:{placeholder:e.row.numColumn},model:{value:e.row.numColumn,callback:function(a){t.$set(e.row,"numColumn",a)},expression:"scope.row.numColumn"}}):a("span",[t._v(t._s(e.row.numColumn))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100",align:"center",prop:"secondGroup"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showHook,expression:"!showHook"}]},[e.row.edit?a("div",[a("el-button",{staticClass:"edit-confirm-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-check",circle:""},on:{click:function(a){return t.editData(e.row,e.column)}}})],1):a("div",[a("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){return t.editData(e.row)}}},[a("i",{staticClass:"el-icon-edit",attrs:{"aria-hidden":"true"}})])],1)]),t._v(" "),a("div",[a("i",{directives:[{name:"show",rawName:"v-show",value:t.showHook,expression:"showHook"}],staticClass:"el-icon-check check"})])]}}],null,!0)})],1)],1),t._v(" "),a("el-table",{staticClass:"group-table",attrs:{data:t.thirtGroup,border:"",stripe:"",size:"mini"},model:{value:t.thirtGroup,callback:function(e){t.thirtGroup=e},expression:"thirtGroup"}},[a("el-table-column",{attrs:{label:"第三组",align:"center"}},[a("el-table-column",{attrs:{prop:"comColumn",label:"科目组合",width:"100",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"numColumn",label:"人数",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?a("el-input",{staticClass:"edit-input",attrs:{placeholder:e.row.numColumn},model:{value:e.row.numColumn,callback:function(a){t.$set(e.row,"numColumn",a)},expression:"scope.row.numColumn"}}):a("span",[t._v(t._s(e.row.numColumn))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100",align:"center",prop:"thirtGroup"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showHook,expression:"!showHook"}]},[e.row.edit?a("div",[a("el-button",{staticClass:"edit-confirm-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-check",circle:""},on:{click:function(a){return t.editData(e.row,e.column)}}})],1):a("div",[a("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){return t.editData(e.row)}}},[a("i",{staticClass:"el-icon-edit",attrs:{"aria-hidden":"true"}})])],1)]),t._v(" "),a("div",[a("i",{directives:[{name:"show",rawName:"v-show",value:t.showHook,expression:"showHook"}],staticClass:"el-icon-check check"})])]}}],null,!0)})],1)],1),t._v(" "),a("div",{staticClass:"first-word"},[t._v("\n            第一阶段不同科目组合人数已完成，请参考评分若需修改\n            "),a("span",[t._v("请手动调整")]),t._v(",若不需修改或修改好请点击\n            "),a("el-button",{staticClass:"modify-btn",attrs:{type:"primary",round:"",size:"mini"},on:{click:t.nextTwoPart}},[t._v(t._s(t.isModify))])],1)],1)]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showSubGroupData,expression:"showSubGroupData"}],staticClass:"next-btn",attrs:{type:"warning",size:"small"},on:{click:t.toRuleTwoStage}},[t._v("下一步")])],1)]}),t._v(" "),[a("el-backtop",{staticClass:".page-component__scroll .el-scrollbar__wrap",attrs:{bottom:100}},[a("div",{staticClass:"up"},[a("i",{staticClass:"el-icon-caret-top"})])])]],2)},staticRenderFns:[]};var s=a("VU/8")(o,r,!1,function(t){a("BQ8w")},"data-v-77cb05df",null);e.default=s.exports},BQ8w:function(t,e){}});
//# sourceMappingURL=10.5204a573cd66bc606704.js.map