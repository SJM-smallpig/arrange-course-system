webpackJsonp([9],{"S+HD":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={components:{},props:{},data:function(){return{showLoading:!0,taskId:"",showInput:!0,isModify:"修改",isShowtwoData:!1,isNameExit:!1,twoStageData:[{status:"进行中",twoStageResultData:[],twoStageScoreData:[]}]}},watch:{},computed:{},methods:{getModify:function(){var t=this.twoStageData[0].twoStageResultData;for(var e in t)for(var a in t[e])0==t[e][a].edit?t[e][a].edit=!0:t[e][a].edit=!1;"确定"==this.isModify?this.isModify="修改":this.isModify="确定"},toRuleThreeStage:function(){"修改"==this.isModify?this.$router.push({path:"@/components/rulesStage/RuleThreeStage",name:"ruleThreeStage",query:{taskId:this.taskId,isNameExit:this.isNameExit}}):alert("请先点击确认修改按钮！")},getTotalAndDiffData:function(t,e){var a=[];for(var s in t)for(var o in t[s])if("string"==typeof t[s][o]&&1==t[s][o].includes("/")){a=t[s][o].split("/");for(var r=0;r<a.length;r++)a[r]=Number(a[r]).toFixed(2);t[s][o]=a.join("/")}for(var i=[],l=[],n=0;n<t.length;n++)i.push(t[n].history.split("/")[1]),l.push(t[n].physics.split("/")[1]);for(var u=0,c=0,p=0;p<i.length;p++)u+=Number(i[p]),c+=Number(l[p]);var d={group:"总计"};d.history=u.toFixed(2),d.physics=c.toFixed(2),t.push(d);var h=[];for(var m in t[3])"group"!=m&&(t[3][m]=Number(t[3][m]).toFixed(2),h.push(t[3][m]));for(var w=[],g=0;g<e.length;g++){var f=e[g]-h[g];w.push(Number(f).toFixed(2))}var v={group:"差值"};v.history=w[0],v.physics=w[1],t.push(v)},getTwoResultStage:function(t){var e=this;e.$axios({url:e.$root.URL+"/runtask?taskId="+t+"&stage=2",method:"post",crossDomain:!0}).then(function(a){200===a.status&&(e.timer=setInterval(function(){e.$axios({url:e.$root.URL+"/result?taskId="+t+"&stage=2&distribution=0",method:"get",crossDomain:!0}).then(function(t){200===t.status&&""!=t.data&&(clearInterval(e.timer),e.getTotalAndDiffData(t.data.scoreData,t.data.minClassNumber),e.twoStageData[0].status="已完成",e.showLoading=!1,e.isShowtwoData=!0,e.twoStageData[0].twoStageResultData=t.data.resultData,e.twoStageData[0].twoStageScoreData=t.data.scoreData)}).catch(function(t){clearInterval(e.timer),t.response?404===t.response.status&&e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):t.request?(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log(t.request)):(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",t.message)),console.log(t.request)})},1e3))}).catch(function(t){console.log(t)})},isTwoResultStage:function(t){var e=this;e.$axios({url:this.$root.URL+"/taskstatus?taskId="+t,method:"get",crossDomain:!0}).then(function(a){if(200===a.status)for(var s in a.data.tasksStageMap)s==t&&(a.data.tasksStageMap[s]<2?e.getTwoResultStage(t):(e.twoStageData[0].status="已完成",e.showLoading=!1,e.isShowtwoData=!0,e.$axios({url:e.$root.URL+"/result?taskId="+t+"&stage=2&distribution=0",method:"get",crossDomain:!0}).then(function(t){200===t.status&&""!=t.data&&(e.getTotalAndDiffData(t.data.scoreData,t.data.minClassNumber),e.twoStageData[0].status="已完成",e.showLoading=!1,e.isShowtwoData=!0,e.twoStageData[0].twoStageResultData=t.data.resultData,e.twoStageData[0].twoStageScoreData=t.data.scoreData)}).catch(function(t){t.response?404===t.response.status&&e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):t.request?(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log(t.request)):(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",t.message)),console.log(t.request)})))}).catch(function(t){t.response?404===t.response.status&&e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"correct"}}):t.request?(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log(t.request)):(e.$router.push({path:"@/views/loginFailed",name:"loginFailed",query:{error:"error"}}),console.log("Error",t.message)),console.log(t.request)})}},created:function(){},mounted:function(){var t=this.$route.query;this.taskId=t.taskId,this.isNameExit=t.isNameExit,this.formData=t.formData,0==this.isNameExit?this.getTwoResultStage(this.taskId):this.isTwoResultStage(this.taskId)},beforeDestroy:function(){clearInterval(this.timer)},beforeRouteLeave:function(t,e,a){t.params.taskId=this.taskId,t.params.form=this.formData,console.log(t.params),a()}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"r-main"},[t._l(t.twoStageData,function(e){return[a("el-form",{key:e.index,staticClass:"demo-table-expand",attrs:{"label-position":"left"}},[a("el-form-item",{attrs:{label:"任务状态"}},[a("span",{staticClass:"status"},[t._v("分班第二阶段:")]),t._v(" "),a("div",{staticClass:"showing"},[a("span",{staticClass:"status"},[t._v(t._s(e.status))]),t._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:!t.isShowtwoData,expression:"!isShowtwoData"}],staticClass:"el-icon-refresh-right status el-making"})])]),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.showLoading,expression:"showLoading"}]},[a("div",{staticClass:"spinner"},[a("div",{staticClass:"bounce1"}),t._v(" "),a("div",{staticClass:"bounce2"}),t._v(" "),a("div",{staticClass:"bounce3"})])]),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.isShowtwoData,expression:"isShowtwoData"}],attrs:{label:""}},[a("div",{staticClass:"stage-two"},[a("div",{staticClass:"result-sty"},[t._v("第二阶段参考评分如下:")]),t._v(" "),a("el-table",{staticClass:"two-score-table",attrs:{data:e.twoStageScoreData,border:"",size:"mini","header-cell-style":{background:"#eef1f6",color:"#606266"}},model:{value:e.twoStageScoreData,callback:function(a){t.$set(e,"twoStageScoreData",a)},expression:"item.twoStageScoreData"}},[a("el-table-column",{attrs:{prop:"group",label:"分组",align:"center",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"history",label:"历史",align:"center",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"physics",label:"物理",align:"center",width:"150px"}})],1),t._v(" "),a("div",{staticClass:"result-sty"},[t._v("第二阶段生成结果如下:")]),t._v(" "),a("el-table",{staticClass:"two-result-table",attrs:{data:e.twoStageResultData,border:"",size:"small","header-cell-style":{background:"#eef1f6",color:"#606266"}},model:{value:e.twoStageResultData,callback:function(a){t.$set(e,"twoStageResultData",a)},expression:"item.twoStageResultData"}},[a("el-table-column",{attrs:{label:"第一组",align:"center"}},[a("el-table-column",{attrs:{prop:"firstGroup.group",label:"组合(历 / 物)",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"firstGroup",label:"比例",align:"center",width:"100px"}},[a("el-table-column",{attrs:{prop:"firstGroup.hisNum",label:"历",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.firstGroup.edit?a("el-input",{staticClass:"edit-input",attrs:{placeholder:e.row.firstGroup.hisNum,size:"mini"},model:{value:e.row.firstGroup.hisNum,callback:function(a){t.$set(e.row.firstGroup,"hisNum",a)},expression:"scope.row.firstGroup.hisNum"}}):a("span",{staticClass:"show-num"},[t._v(t._s(e.row.firstGroup.hisNum))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"firstGroup.phyNum",label:"物",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.firstGroup.edit?a("el-input",{staticClass:"edit-input",attrs:{placeholder:e.row.firstGroup.phyNum,size:"mini"},model:{value:e.row.firstGroup.phyNum,callback:function(a){t.$set(e.row.firstGroup,"phyNum",a)},expression:"scope.row.firstGroup.phyNum"}}):a("span",{staticClass:"show-num"},[t._v(t._s(e.row.firstGroup.phyNum))])]}}],null,!0)})],1)],1),t._v(" "),a("el-table-column",{attrs:{label:"第二组",align:"center"}},[a("el-table-column",{attrs:{prop:"secondGroup.group",label:"组合(历 / 物)",align:"center",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"secondGroup",label:"比例",align:"center",width:"100px"}},[a("el-table-column",{attrs:{prop:"secondGroup.hisNum",label:"历",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.secondGroup.edit?a("el-input",{staticClass:"edit-input",attrs:{placeholder:e.row.secondGroup.hisNum,size:"mini"},model:{value:e.row.secondGroup.hisNum,callback:function(a){t.$set(e.row.secondGroup,"hisNum",a)},expression:"scope.row.secondGroup.hisNum"}}):a("span",[t._v(t._s(e.row.secondGroup.hisNum))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"secondGroup.phyNum",label:"物",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.secondGroup.edit?a("el-input",{staticClass:"edit-input",attrs:{placeholder:e.row.secondGroup.phyNum,size:"mini"},model:{value:e.row.secondGroup.phyNum,callback:function(a){t.$set(e.row.secondGroup,"phyNum",a)},expression:"scope.row.secondGroup.phyNum"}}):a("span",[t._v(t._s(e.row.secondGroup.phyNum))])]}}],null,!0)})],1)],1),t._v(" "),a("el-table-column",{attrs:{label:"第三组",align:"center"}},[a("el-table-column",{attrs:{prop:"thirdGroup.group",label:"组合(历 / 物)",align:"center",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"thirdGroup",label:"比例",align:"center",width:"100px"}},[a("el-table-column",{attrs:{prop:"thirdGroup.hisNum",label:"历",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.thirdGroup.edit?a("el-input",{staticClass:"edit-input",attrs:{placeholder:e.row.thirdGroup.hisNum,size:"mini"},model:{value:e.row.thirdGroup.hisNum,callback:function(a){t.$set(e.row.thirdGroup,"hisNum",a)},expression:"scope.row.thirdGroup.hisNum"}}):a("span",[t._v(t._s(e.row.thirdGroup.hisNum))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"thirdGroup.phyNum",label:"物",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.thirdGroup.edit?a("el-input",{staticClass:"edit-input",attrs:{placeholder:e.row.thirdGroup.phyNum,size:"mini"},model:{value:e.row.thirdGroup.phyNum,callback:function(a){t.$set(e.row.thirdGroup,"phyNum",a)},expression:"scope.row.thirdGroup.phyNum"}}):a("span",[t._v(t._s(e.row.thirdGroup.phyNum))])]}}],null,!0)})],1)],1)],1),t._v(" "),a("div",{staticClass:"second-word"},[t._v("\n            第二阶段组合人数已完成，请参考评分若需修改\n            "),a("span",[t._v("请手动调整")]),t._v(",若不需修改或修改好请点击\n            "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:t.getModify}},[t._v(t._s(t.isModify))])],1)],1)]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isShowtwoData,expression:"isShowtwoData"}],staticClass:"next-btn",attrs:{type:"warning",size:"small"},on:{click:t.toRuleThreeStage}},[t._v("下一步")])],1)]}),t._v(" "),[a("el-backtop",{staticClass:".page-component__scroll .el-scrollbar__wrap",attrs:{bottom:100}},[a("div",{staticClass:"up"},[a("i",{staticClass:"el-icon-caret-top"})])])]],2)},staticRenderFns:[]};var r=a("VU/8")(s,o,!1,function(t){a("id9/")},"data-v-84ae3c90",null);e.default=r.exports},"id9/":function(t,e){}});
//# sourceMappingURL=9.b27776e25455763374ce.js.map